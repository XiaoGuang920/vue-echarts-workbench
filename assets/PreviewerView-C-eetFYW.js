import{d as he,r as i,c as ke,o as we,x as _e,a as c,b as r,e as a,w as oe,F as m,f as j,g as d,h as g,u as v,i as se,j as xe,y as Ce,z as Ve,n as ne,m as x,l as O,v as R,p as Se,t as b,A as je,B as Ae,C as Ee,E as Re,G as $e,H as De,I as Ne,J as Oe,k as U,Q as J,K as ue,L as re,M as L,N as Ue,T as ce,O as ie,P as Ie,D as Te,R as Me,_ as ze}from"./index-COQn4yGY.js";const Pe={class:"container"},Fe={class:"scroll-container"},He={class:"grid h-full gap-4 sm:grid-cols-2"},Je={class:"input-title"},Le={class:"input-content"},Be=["placeholder","onUpdate:modelValue"],We=["placeholder","onUpdate:modelValue"],Ge=["placeholder","onUpdate:modelValue"],Xe=["placeholder","onUpdate:modelValue"],Qe=["onClick"],Ye=["value","onUpdate:modelValue"],Ke=["onClick"],qe=["value","onUpdate:modelValue"],Ze={class:"popup-footer"},et={class:"flex gap-4"},tt={class:"align-center flex justify-between border-b border-[#e5e7eb] bg-[#f9fafb] p-4"},lt={class:"relative min-h-0 flex-1"},at={key:0,class:"absolute bottom-0 left-0 flex w-full items-center gap-2 bg-red-200 p-2 text-base text-red-400"},ot={class:"grid flex-shrink-0 grid-flow-row gap-4 border-t border-[#e5e7eb] bg-[#f9fafb] p-4"},st={class:"flex h-10 w-full gap-4"},nt={class:"flex h-10 w-1/5 items-center justify-center gap-2 rounded-md bg-[#59AC77] px-4 py-2 text-sm font-semibold text-white hover:bg-[#3A6F43]"},ut={class:"flex h-10 w-full gap-4"},rt={class:"flex h-10 w-1/2 items-center justify-center gap-2 rounded-md bg-[#456882] px-4 py-2 text-sm font-semibold text-white hover:bg-[#234C6A]"},ct={class:"flex h-10 w-1/2 items-center justify-center gap-2 rounded-md bg-[#456882] px-4 py-2 text-sm font-semibold text-white hover:bg-[#234C6A]"},it={class:"flex h-10 w-full gap-4"},dt={class:"flex h-10 w-1/2 items-center justify-center gap-2 rounded-md bg-gray-500 px-4 py-2 text-sm font-semibold text-white hover:bg-gray-600"},vt={class:"flex h-10 w-1/2 items-center justify-center gap-2 rounded-md bg-[#456882] px-4 py-2 text-sm font-semibold text-white hover:bg-[#234C6A]"},pt={class:"relative flex items-center gap-2 rounded-full bg-[#DDDDDD] px-8 py-4 text-base font-bold text-[#44444e] shadow-lg"},ft={class:"filter-tag-container"},mt={class:"filter-tag-text"},bt={class:"chart-grid mt-6"},gt=he({__name:"PreviewerView",setup(yt){const p=i([]),I=i([]),T=i(!1),M=i(!0),C=i({}),_=i({}),V=i({}),h=i({}),k=i({}),w=i({}),y=i({}),u=i({}),$=i({}),B=i({}),f=i({}),W=i({}),S=i(""),D=i(""),z=i(),P=i(),de=ke(()=>S.value?Math.max(1,S.value.split(`
`).length):1);function N(){X(),T.value=!T.value}function F(){M.value=!M.value}function G(t,e){t&&(B.value[e]=t,f.value[e]===void 0&&(f.value[e]=!1))}function H(t,e,l){t&&(l?$.value[`${e}-${l}`]=t:$.value[e]=t)}function X(){Object.keys(f.value).forEach(t=>{const e=parseInt(t,10);f.value[e]=!1})}function Q(t){const e=p.value[t];(e.type==="singleSelect"||e.type==="multiSelect")&&(f.value[t]=!f.value[t],f.value[t]&&Me(()=>{Y(t)}))}function Y(t){const e=B.value[t];if(e){const l=e.getBoundingClientRect();W.value[t]={top:l.bottom,left:l.left,width:l.width}}}function K(t){const e=W.value[t];return e?{position:"fixed",top:`${e.top}px`,left:`${e.left}px`,width:`${e.width}px`,zIndex:1e4}:{}}function ve(){z.value&&P.value&&(P.value.scrollTop=z.value.scrollTop)}function pe(){try{const t=JSON.parse(S.value);I.value=t,D.value=""}catch(t){console.error("Invalid JSON format:",t),D.value=`Invalid JSON format: ${t.message}`}}function fe(){Object.keys(f.value).forEach(t=>{const e=parseInt(t,10);f.value[e]=!1}),Object.keys($.value).forEach(t=>{$.value[t]?.closeMenu()})}function me(){Object.keys(f.value).forEach(t=>{const e=parseInt(t,10);f.value[e]&&Y(e)})}function be(t,e){let l;return function(){l||(t(),l=!0,setTimeout(()=>l=!1,e))}}const q=be(me,200);function A(t){return t?typeof t=="string"?t:t.start:""}function Z(t){return t?typeof t=="string"?t:t.end:""}function ee(t,e){if(!e||!t.options)return"";const l=t.options.find(o=>o.value===e);return l?l.label:e}function te(t,e){return!e||!t.options?"":e.map(l=>{const o=t.options.find(s=>s.value===l);return o?o.label:l}).filter(Boolean).join(", ")}function le(){Object.keys(C.value).forEach(t=>{const e=parseInt(t,10);C.value[e]?(u.value[e]=C.value[e],u.value[e]=p.value[e].label+": "+u.value[e]):delete u.value[e]}),Object.keys(_.value).forEach(t=>{const e=parseInt(t,10);_.value[e]!==void 0&&_.value[e]!==null?(u.value[e]=_.value[e].toString()+p.value[e].unit,u.value[e]=p.value[e].label+": "+u.value[e]):delete u.value[e]}),Object.keys(V.value).forEach(t=>{const e=parseInt(t,10);V.value[e]?(u.value[e]=V.value[e].toLocaleString(),u.value[e]=p.value[e].label+": "+u.value[e]):delete u.value[e]}),Object.keys(h.value).forEach(t=>{const e=parseInt(t,10),l=h.value[e];l&&l.start&&l.end?(u.value[e]=`${l.start.toLocaleString()} ~ ${l.end.toLocaleString()}`,u.value[e]=p.value[e].label+": "+u.value[e]):delete u.value[e]}),Object.keys(k.value).forEach(t=>{const e=parseInt(t,10),l=k.value[e];if(l&&l.start!==void 0&&l.end!==void 0){const o=p.value[e].unit;u.value[e]=`${l.start}${o} ~ ${l.end}${o}`,u.value[e]=p.value[e].label+": "+u.value[e]}else delete u.value[e]}),Object.keys(w.value).forEach(t=>{const e=parseInt(t,10),l=p.value[e];w.value[e]?(u.value[e]=ee(l,w.value[e])||w.value[e],u.value[e]=p.value[e].label+": "+u.value[e]):delete u.value[e]}),Object.keys(y.value).forEach(t=>{const e=parseInt(t,10),l=p.value[e];y.value[e]&&y.value[e].length>0?(u.value[e]=te(l,y.value[e])||y.value[e].join(", "),u.value[e]=p.value[e].label+": "+u.value[e]):delete u.value[e]})}function ae(){p.value.forEach((t,e)=>{if(!(t.default===void 0||t.default==null))switch(t.type){case"text":C.value[e]=t.default||"";break;case"number":_.value[e]=t.default||0;break;case"date":V.value[e]=t.default?new Date(t.default):null;break;case"dateRange":if(t.default&&typeof t.default=="object"&&!Array.isArray(t.default)){const l=t.default;h.value[e]={start:new Date(l.start),end:new Date(l.end)}}else h.value[e]={start:null,end:null};break;case"numberRange":if(t.default&&typeof t.default=="object"&&!Array.isArray(t.default)){const l=t.default;k.value[e]={start:l.start,end:l.end}}else k.value[e]={start:0,end:0};break;case"singleSelect":w.value[e]=t.default||"";break;case"multiSelect":y.value[e]=t.default||[];break}}),X()}function ge(){le(),N()}function ye(t){const e=t.gridX||1,l=t.gridY||1,o=t.gridWidth||4,s=t.gridHeight||4,n=e+o,E=l+s;return{gridColumn:`${e} / ${n}`,gridRow:`${l} / ${E}`,minHeight:`${s*180}px`}}return we(async()=>{try{const t=await fetch("/vue-echarts-workbench//data/pages/demo-charts.json");if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const e=await t.json();e.filters&&(p.value=e.filters,ae(),le()),I.value=e.charts||[],S.value=JSON.stringify(e,null,2)}catch(t){console.error("Error fetching chart data:",t)}window.addEventListener("resize",q)}),_e(()=>{window.removeEventListener("resize",q)}),(t,e)=>{const l=xe("FontAwesomeIcon");return r(),c("div",Pe,[a("div",{class:ne(["popup-model",{active:T.value}]),onClick:N},[a("div",{class:"popup-content shadow-lg",onClick:e[2]||(e[2]=oe(()=>{},["stop"]))},[a("div",{class:"popup-body",onScroll:fe},[a("div",Fe,[a("div",He,[(r(!0),c(m,null,j(p.value,(o,s)=>(r(),c("div",{key:s,class:"input-group"},[a("div",Je,b(o.label),1),a("div",Le,[o.type=="text"?x((r(),c("input",{key:0,class:"text-input",type:"text",placeholder:A(o.placeholder),"onUpdate:modelValue":n=>C.value[s]=n},null,8,Be)),[[R,C.value[s]]]):o.type=="date"?(r(),U(v(J),{key:1,ref_for:!0,ref:n=>H(n,s),placeholder:A(o.placeholder),modelValue:V.value[s],"onUpdate:modelValue":n=>V.value[s]=n,format:"yyyy-MM-dd HH:mm:ss","enable-time-picker":!0,locale:"zh-TW",teleport:!0,"z-index":1e4},null,8,["placeholder","modelValue","onUpdate:modelValue"])):o.type=="dateRange"?(r(),c(m,{key:2},[d(v(J),{ref_for:!0,ref:n=>H(n,s,"start"),placeholder:A(o.placeholder),modelValue:h.value[s].start,"onUpdate:modelValue":n=>h.value[s].start=n,format:"yyyy-MM-dd HH:mm:ss","enable-time-picker":!0,locale:"zh-TW",teleport:!0,"z-index":1e4},null,8,["placeholder","modelValue","onUpdate:modelValue"]),e[5]||(e[5]=a("span",null,"~",-1)),d(v(J),{ref_for:!0,ref:n=>H(n,s,"end"),placeholder:Z(o.placeholder),modelValue:h.value[s].end,"onUpdate:modelValue":n=>h.value[s].end=n,format:"yyyy-MM-dd HH:mm:ss","enable-time-picker":!0,locale:"zh-TW",teleport:!0,"z-index":1e4},null,8,["placeholder","modelValue","onUpdate:modelValue"])],64)):o.type=="number"?(r(),c(m,{key:3},[x(a("input",{type:"number",placeholder:A(o.placeholder),"onUpdate:modelValue":n=>_.value[s]=n},null,8,We),[[R,_.value[s]]]),a("span",null,b(o.unit),1)],64)):o.type=="numberRange"?(r(),c(m,{key:4},[x(a("input",{type:"number",placeholder:A(o.placeholder),"onUpdate:modelValue":n=>k.value[s].start=n},null,8,Ge),[[R,k.value[s].start]]),a("span",null,b(o.unit),1),e[6]||(e[6]=a("span",null,"~",-1)),x(a("input",{type:"number",placeholder:Z(o.placeholder),"onUpdate:modelValue":n=>k.value[s].end=n},null,8,Xe),[[R,k.value[s].end]]),a("span",null,b(o.unit),1)],64)):o.type=="singleSelect"?(r(),c(m,{key:5},[a("div",{class:"select-title",ref_for:!0,ref:n=>G(n,s),onClick:n=>Q(s)},[a("span",null,b(ee(o,w.value[s])||o.placeholder),1),d(l,{icon:v(ue)},null,8,["icon"])],8,Qe),d(ie,{name:"fade",mode:"out-in"},{default:re(()=>[(r(),U(ce,{to:"body"},[f.value[s]?(r(),c("div",{key:0,class:"select-options",style:L(K(s))},[(r(!0),c(m,null,j(o.options,n=>(r(),c("label",{key:n.value},[x(a("input",{type:"radio",value:n.value,"onUpdate:modelValue":E=>w.value[s]=E},null,8,Ye),[[Ue,w.value[s]]]),a("span",null,b(n.label),1)]))),128))],4)):O("",!0)]))]),_:2},1024)],64)):o.type=="multiSelect"?(r(),c(m,{key:6},[a("div",{class:"select-title",ref_for:!0,ref:n=>G(n,s),onClick:n=>Q(s)},[a("span",null,b(te(o,y.value[s])||o.placeholder),1),d(l,{icon:v(ue)},null,8,["icon"])],8,Ke),d(ie,{name:"fade",mode:"out-in"},{default:re(()=>[(r(),U(ce,{to:"body"},[f.value[s]?(r(),c("div",{key:0,class:"select-options",style:L(K(s))},[(r(!0),c(m,null,j(o.options,n=>(r(),c("label",{key:n.value},[x(a("input",{type:"checkbox",value:n.value,"onUpdate:modelValue":E=>y.value[s]=E},null,8,qe),[[Ie,y.value[s]]]),a("span",null,b(n.label),1)]))),128))],4)):O("",!0)]))]),_:2},1024)],64)):O("",!0)])]))),128))])])],32),a("div",Ze,[a("button",{class:"flex w-[8rem] items-center justify-center rounded-full bg-gray-500 px-4 py-2 text-sm font-semibold text-white hover:bg-gray-600",onClick:N},[d(l,{icon:v(se),class:"mr-1"},null,8,["icon"]),e[7]||(e[7]=g("關閉 ",-1))]),a("div",et,[a("button",{class:"flex w-[8rem] items-center justify-center rounded-full bg-blue-400 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-500",onClick:e[0]||(e[0]=o=>ae())},[d(l,{icon:v(Ce),class:"mr-1"},null,8,["icon"]),e[8]||(e[8]=g("重置 ",-1))]),a("button",{class:"flex w-[8rem] items-center justify-center rounded-full bg-blue-500 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-600",onClick:e[1]||(e[1]=o=>ge())},[d(l,{icon:v(Ve),class:"mr-1"},null,8,["icon"]),e[9]||(e[9]=g("套用 ",-1))])])])])],2),a("div",{class:ne(["chart-settings popup-model",{active:M.value}]),onClick:F},[a("div",{class:"popup-content flex h-full flex-col",onClick:e[4]||(e[4]=oe(()=>{},["stop"]))},[a("div",tt,[e[10]||(e[10]=a("span",{class:"text-base font-bold text-[#44444e]"},"JSON 編輯器",-1)),a("button",{class:"text-[#44444e]",onClick:F},[d(l,{icon:v(se)},null,8,["icon"])])]),a("div",lt,[a("div",{ref_key:"lineNumbersRef",ref:P,class:"absolute left-0 top-0 h-full overflow-hidden bg-gray-100 text-right text-base text-gray-500"},[(r(!0),c(m,null,j(de.value,o=>(r(),c("div",{key:o,class:"px-2"},b(o),1))),128))],512),x(a("textarea",{ref_key:"textareaRef",ref:z,class:"ml-14 h-full w-full resize-none bg-transparent p-0 text-base text-[#37353E] outline-none",placeholder:"在此編輯 ECharts 配置...","onUpdate:modelValue":e[3]||(e[3]=o=>S.value=o),onInput:pe,onScroll:ve,spellcheck:"false"},null,544),[[R,S.value]]),D.value?(r(),c("div",at,[d(l,{icon:v(Se)},null,8,["icon"]),g(" "+b(D.value),1)])):O("",!0)]),a("div",ot,[a("div",st,[e[12]||(e[12]=a("input",{class:"w-4/5 rounded border border-gray-300 px-3 py-2",type:"text",placeholder:"請輸入 API"},null,-1)),a("button",nt,[d(l,{icon:v(je)},null,8,["icon"]),e[11]||(e[11]=g("測試 ",-1))])]),a("div",ut,[a("button",rt,[d(l,{icon:v(Ae)},null,8,["icon"]),e[13]||(e[13]=g("載入範例 ",-1))]),a("button",ct,[d(l,{icon:v(Ee)},null,8,["icon"]),e[14]||(e[14]=g("下載 JSON ",-1))])]),a("div",it,[a("button",dt,[d(l,{icon:v(Re)},null,8,["icon"]),e[15]||(e[15]=g("重製 ",-1))]),a("button",vt,[d(l,{icon:v($e)},null,8,["icon"]),e[16]||(e[16]=g("套用 ",-1))])])])])],2),a("div",pt,[d(l,{icon:v(De),class:"text-[#456882]"},null,8,["icon"]),e[18]||(e[18]=g(" 篩選項 ",-1)),a("div",ft,[(r(!0),c(m,null,j(u.value,(o,s)=>(r(),c("div",{class:"filter-tag",key:s},[e[17]||(e[17]=a("div",{class:"filter-tag-hole"},null,-1)),a("span",mt,b(o),1)]))),128))]),a("button",{class:"absolute right-6 top-1/2 -translate-y-1/2 text-base text-[#456882]",onClick:N},[d(l,{icon:v(Ne)},null,8,["icon"])])]),a("div",bt,[(r(!0),c(m,null,j(I.value,(o,s)=>(r(),c("div",{key:s,style:L(ye(o)),class:"overflow-hidden rounded-lg bg-white shadow-lg"},[(r(),U(Te,{key:s,"chart-json":o},null,8,["chart-json"]))],4))),128))]),a("button",{class:"chart-options-btn",onClick:F},[d(l,{icon:v(Oe)},null,8,["icon"])])])}}}),kt=ze(gt,[["__scopeId","data-v-54f01d15"]]);export{kt as default};
