import{d as ue,r as d,o as re,x as ce,a as c,b as r,e as n,w as ie,F as f,f as $,g as p,h as E,u as m,i as de,j as ve,y as pe,z as fe,n as me,H as ye,I as be,t as b,m as S,k as A,l as I,v as M,Q as N,K as Z,L as x,M as T,N as he,T as ee,O as te,P as ge,D as ke,R as we,_ as _e}from"./index-Dkj8pyCn.js";const Ve={class:"container"},Se={class:"scroll-container"},je={class:"grid h-full gap-4 sm:grid-cols-2"},Ce={class:"input-title"},$e={class:"input-content"},Ue=["placeholder","onUpdate:modelValue"],De=["placeholder","onUpdate:modelValue"],Ee=["placeholder","onUpdate:modelValue"],Ae=["placeholder","onUpdate:modelValue"],Me=["onClick"],Re=["value","onUpdate:modelValue"],ze=["onClick"],Ie=["value","onUpdate:modelValue"],Ne={class:"popup-footer"},Te={class:"flex gap-4"},Oe={class:"relative flex items-center gap-2 rounded-full bg-[#DDDDDD] px-8 py-4 text-base font-bold text-[#44444e] shadow-lg"},He={class:"filter-tag-container"},Pe={class:"filter-tag-text"},Fe={class:"chart-grid mt-6"},Le=ue({__name:"MigrationView",setup(Be){const i=d([]),O=d([]),R=d(!1),_=d({}),w=d({}),V=d({}),h=d({}),g=d({}),k=d({}),y=d({}),u=d({}),U=d({}),H=d({}),v=d({}),P=d({});function D(){L(),R.value=!R.value}function F(t,e){t&&(H.value[e]=t,v.value[e]===void 0&&(v.value[e]=!1))}function z(t,e,l){t&&(l?U.value[`${e}-${l}`]=t:U.value[e]=t)}function L(){Object.keys(v.value).forEach(t=>{const e=parseInt(t,10);v.value[e]=!1})}function B(t){const e=i.value[t];(e.type==="singleSelect"||e.type==="multiSelect")&&(v.value[t]=!v.value[t],v.value[t]&&we(()=>{W(t)}))}function W(t){const e=H.value[t];if(e){const l=e.getBoundingClientRect();P.value[t]={top:l.bottom,left:l.left,width:l.width}}}function G(t){const e=P.value[t];return e?{position:"fixed",top:`${e.top}px`,left:`${e.left}px`,width:`${e.width}px`,zIndex:1e4}:{}}function le(){Object.keys(v.value).forEach(t=>{const e=parseInt(t,10);v.value[e]=!1}),Object.keys(U.value).forEach(t=>{U.value[t]?.closeMenu()})}function ae(){Object.keys(v.value).forEach(t=>{const e=parseInt(t,10);v.value[e]&&W(e)})}function oe(t,e){let l;return function(){l||(t(),l=!0,setTimeout(()=>l=!1,e))}}const X=oe(ae,200);function j(t){return t?typeof t=="string"?t:t.start:""}function Q(t){return t?typeof t=="string"?t:t.end:""}function Y(t,e){if(!e||!t.options)return"";const l=t.options.find(o=>o.value===e);return l?l.label:e}function K(t,e){return!e||!t.options?"":e.map(l=>{const o=t.options.find(a=>a.value===l);return o?o.label:l}).filter(Boolean).join(", ")}function q(){Object.keys(_.value).forEach(t=>{const e=parseInt(t,10);_.value[e]?(u.value[e]=_.value[e],u.value[e]=i.value[e].label+": "+u.value[e]):delete u.value[e]}),Object.keys(w.value).forEach(t=>{const e=parseInt(t,10);w.value[e]!==void 0&&w.value[e]!==null?(u.value[e]=w.value[e].toString()+i.value[e].unit,u.value[e]=i.value[e].label+": "+u.value[e]):delete u.value[e]}),Object.keys(V.value).forEach(t=>{const e=parseInt(t,10);V.value[e]?(u.value[e]=V.value[e].toLocaleString(),u.value[e]=i.value[e].label+": "+u.value[e]):delete u.value[e]}),Object.keys(h.value).forEach(t=>{const e=parseInt(t,10),l=h.value[e];l&&l.start&&l.end?(u.value[e]=`${l.start.toLocaleString()} ~ ${l.end.toLocaleString()}`,u.value[e]=i.value[e].label+": "+u.value[e]):delete u.value[e]}),Object.keys(g.value).forEach(t=>{const e=parseInt(t,10),l=g.value[e];if(l&&l.start!==void 0&&l.end!==void 0){const o=i.value[e].unit;u.value[e]=`${l.start}${o} ~ ${l.end}${o}`,u.value[e]=i.value[e].label+": "+u.value[e]}else delete u.value[e]}),Object.keys(k.value).forEach(t=>{const e=parseInt(t,10),l=i.value[e];k.value[e]?(u.value[e]=Y(l,k.value[e])||k.value[e],u.value[e]=i.value[e].label+": "+u.value[e]):delete u.value[e]}),Object.keys(y.value).forEach(t=>{const e=parseInt(t,10),l=i.value[e];y.value[e]&&y.value[e].length>0?(u.value[e]=K(l,y.value[e])||y.value[e].join(", "),u.value[e]=i.value[e].label+": "+u.value[e]):delete u.value[e]})}function J(){i.value.forEach((t,e)=>{if(!(t.default===void 0||t.default==null))switch(t.type){case"text":_.value[e]=t.default||"";break;case"number":w.value[e]=t.default||0;break;case"date":V.value[e]=t.default?new Date(t.default):null;break;case"dateRange":if(t.default&&typeof t.default=="object"&&!Array.isArray(t.default)){const l=t.default;h.value[e]={start:new Date(l.start),end:new Date(l.end)}}else h.value[e]={start:null,end:null};break;case"numberRange":if(t.default&&typeof t.default=="object"&&!Array.isArray(t.default)){const l=t.default;g.value[e]={start:l.start,end:l.end}}else g.value[e]={start:0,end:0};break;case"singleSelect":k.value[e]=t.default||"";break;case"multiSelect":y.value[e]=t.default||[];break}}),L()}function se(){q(),D()}function ne(t){const e=t.gridX||1,l=t.gridY||1,o=t.gridWidth||4,a=t.gridHeight||4,s=e+o,C=l+a;return{gridColumn:`${e} / ${s}`,gridRow:`${l} / ${C}`,minHeight:`${a*180}px`}}return re(async()=>{try{const t="http://vms-dev-2062032097.ap-southeast-1.elb.amazonaws.com/chart/myagent/dashboard/charts-filters",e=await fetch(t);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const l=await e.json();l.filters&&(i.value=l.filters,J(),q(),O.value=l.charts||[])}catch(t){console.error("Error fetching chart data:",t)}window.addEventListener("resize",X)}),ce(()=>{window.removeEventListener("resize",X)}),(t,e)=>{const l=ve("FontAwesomeIcon");return r(),c("div",Ve,[n("div",{class:me(["popup-model",{active:R.value}]),onClick:D},[n("div",{class:"popup-content shadow-lg",onClick:e[2]||(e[2]=ie(()=>{},["stop"]))},[n("div",{class:"popup-body",onScroll:le},[n("div",Se,[n("div",je,[(r(!0),c(f,null,$(i.value,(o,a)=>(r(),c("div",{key:a,class:"input-group"},[n("div",Ce,b(o.label),1),n("div",$e,[o.type=="text"?S((r(),c("input",{key:0,class:"text-input",type:"text",placeholder:j(o.placeholder),"onUpdate:modelValue":s=>_.value[a]=s},null,8,Ue)),[[M,_.value[a]]]):o.type=="date"?(r(),A(m(N),{key:1,ref_for:!0,ref:s=>z(s,a),placeholder:j(o.placeholder),modelValue:V.value[a],"onUpdate:modelValue":s=>V.value[a]=s,format:"yyyy-MM-dd HH:mm:ss","enable-time-picker":!0,locale:"zh-TW",teleport:!0,"z-index":1e4},null,8,["placeholder","modelValue","onUpdate:modelValue"])):o.type=="dateRange"?(r(),c(f,{key:2},[p(m(N),{ref_for:!0,ref:s=>z(s,a,"start"),placeholder:j(o.placeholder),modelValue:h.value[a].start,"onUpdate:modelValue":s=>h.value[a].start=s,format:"yyyy-MM-dd HH:mm:ss","enable-time-picker":!0,locale:"zh-TW",teleport:!0,"z-index":1e4},null,8,["placeholder","modelValue","onUpdate:modelValue"]),e[3]||(e[3]=n("span",null,"~",-1)),p(m(N),{ref_for:!0,ref:s=>z(s,a,"end"),placeholder:Q(o.placeholder),modelValue:h.value[a].end,"onUpdate:modelValue":s=>h.value[a].end=s,format:"yyyy-MM-dd HH:mm:ss","enable-time-picker":!0,locale:"zh-TW",teleport:!0,"z-index":1e4},null,8,["placeholder","modelValue","onUpdate:modelValue"])],64)):o.type=="number"?(r(),c(f,{key:3},[S(n("input",{type:"number",placeholder:j(o.placeholder),"onUpdate:modelValue":s=>w.value[a]=s},null,8,De),[[M,w.value[a]]]),n("span",null,b(o.unit),1)],64)):o.type=="numberRange"?(r(),c(f,{key:4},[S(n("input",{type:"number",placeholder:j(o.placeholder),"onUpdate:modelValue":s=>g.value[a].start=s},null,8,Ee),[[M,g.value[a].start]]),n("span",null,b(o.unit),1),e[4]||(e[4]=n("span",null,"~",-1)),S(n("input",{type:"number",placeholder:Q(o.placeholder),"onUpdate:modelValue":s=>g.value[a].end=s},null,8,Ae),[[M,g.value[a].end]]),n("span",null,b(o.unit),1)],64)):o.type=="singleSelect"?(r(),c(f,{key:5},[n("div",{class:"select-title",ref_for:!0,ref:s=>F(s,a),onClick:s=>B(a)},[n("span",null,b(Y(o,k.value[a])||o.placeholder),1),p(l,{icon:m(Z)},null,8,["icon"])],8,Me),p(te,{name:"fade",mode:"out-in"},{default:x(()=>[(r(),A(ee,{to:"body"},[v.value[a]?(r(),c("div",{key:0,class:"select-options",style:T(G(a))},[(r(!0),c(f,null,$(o.options,s=>(r(),c("label",{key:s.value},[S(n("input",{type:"radio",value:s.value,"onUpdate:modelValue":C=>k.value[a]=C},null,8,Re),[[he,k.value[a]]]),n("span",null,b(s.label),1)]))),128))],4)):I("",!0)]))]),_:2},1024)],64)):o.type=="multiSelect"?(r(),c(f,{key:6},[n("div",{class:"select-title",ref_for:!0,ref:s=>F(s,a),onClick:s=>B(a)},[n("span",null,b(K(o,y.value[a])||o.placeholder),1),p(l,{icon:m(Z)},null,8,["icon"])],8,ze),p(te,{name:"fade",mode:"out-in"},{default:x(()=>[(r(),A(ee,{to:"body"},[v.value[a]?(r(),c("div",{key:0,class:"select-options",style:T(G(a))},[(r(!0),c(f,null,$(o.options,s=>(r(),c("label",{key:s.value},[S(n("input",{type:"checkbox",value:s.value,"onUpdate:modelValue":C=>y.value[a]=C},null,8,Ie),[[ge,y.value[a]]]),n("span",null,b(s.label),1)]))),128))],4)):I("",!0)]))]),_:2},1024)],64)):I("",!0)])]))),128))])])],32),n("div",Ne,[n("button",{class:"flex w-[8rem] items-center justify-center rounded-full bg-gray-500 px-4 py-2 text-sm font-semibold text-white hover:bg-gray-600",onClick:D},[p(l,{icon:m(de),class:"mr-1"},null,8,["icon"]),e[5]||(e[5]=E("關閉 ",-1))]),n("div",Te,[n("button",{class:"flex w-[8rem] items-center justify-center rounded-full bg-blue-400 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-500",onClick:e[0]||(e[0]=o=>J())},[p(l,{icon:m(pe),class:"mr-1"},null,8,["icon"]),e[6]||(e[6]=E("重置 ",-1))]),n("button",{class:"flex w-[8rem] items-center justify-center rounded-full bg-blue-500 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-600",onClick:e[1]||(e[1]=o=>se())},[p(l,{icon:m(fe),class:"mr-1"},null,8,["icon"]),e[7]||(e[7]=E("套用 ",-1))])])])])],2),n("div",Oe,[p(l,{icon:m(ye),class:"text-[#456882]"},null,8,["icon"]),e[9]||(e[9]=E(" 篩選項 ",-1)),n("div",He,[(r(!0),c(f,null,$(u.value,(o,a)=>(r(),c("div",{class:"filter-tag",key:a},[e[8]||(e[8]=n("div",{class:"filter-tag-hole"},null,-1)),n("span",Pe,b(o),1)]))),128))]),n("button",{class:"absolute right-6 top-1/2 -translate-y-1/2 text-base text-[#456882]",onClick:D},[p(l,{icon:m(be)},null,8,["icon"])])]),n("div",Fe,[(r(!0),c(f,null,$(O.value,(o,a)=>(r(),c("div",{key:a,style:T(ne(o)),class:"overflow-hidden rounded-lg bg-white shadow-lg"},[(r(),A(ke,{key:a,"chart-json":o},null,8,["chart-json"]))],4))),128))])])}}}),Ge=_e(Le,[["__scopeId","data-v-96b5744e"]]);export{Ge as default};
