import{d as de,r as i,o as ve,x as pe,a as c,b as r,e as n,w as fe,g as p,h as U,u as f,y as me,j as ye,F as m,f as $,i as he,z as be,A as ge,n as ke,I as we,J as _e,t as h,m as j,k as D,l as T,v as R,Q as O,N as ae,O as oe,K as F,P as Ve,T as se,R as ne,S as Se,D as je,V as Ce,_ as Ee}from"./index-BBcybKfD.js";const Ue={class:"container"},$e={key:0,class:"flex h-[50vh] flex-col items-center justify-center gap-2 p-4 text-xl font-bold text-[#374151]"},ze={class:"scroll-container"},Ae={class:"grid h-full gap-4 sm:grid-cols-2"},De={class:"input-title"},Re={class:"input-content"},Ie=["placeholder","onUpdate:modelValue"],Me=["placeholder","onUpdate:modelValue"],Ne=["placeholder","onUpdate:modelValue"],Te=["placeholder","onUpdate:modelValue"],Oe=["onClick"],Fe=["value","onUpdate:modelValue"],He=["onClick"],Le=["value","onUpdate:modelValue"],Pe={class:"popup-footer"},Be={class:"flex gap-4"},xe={class:"relative flex items-center gap-2 rounded-full bg-[#DDDDDD] px-8 py-4 text-base text-[#44444e] shadow-lg"},We={class:"w-fit flex-shrink-0 font-bold"},Ge={class:"filter-tag-container"},Xe={class:"filter-tag-text"},Qe=de({__name:"MigrationView",setup(Ye){const d=i([]),H=i([]),I=i(!1),_=i({}),w=i({}),V=i({}),b=i({}),g=i({}),k=i({}),y=i({}),u=i({}),z=i({}),L=i({}),v=i({}),P=i({}),M=i(),S=i(180);function A(){x(),I.value=!I.value}function B(t,e){t&&(L.value[e]=t,v.value[e]===void 0&&(v.value[e]=!1))}function N(t,e,l){t&&(l?z.value[`${e}-${l}`]=t:z.value[e]=t)}function x(){Object.keys(v.value).forEach(t=>{const e=parseInt(t,10);v.value[e]=!1})}function W(t){const e=d.value[t];(e.type==="singleSelect"||e.type==="multiSelect")&&(v.value[t]=!v.value[t],v.value[t]&&Ce(()=>{G(t)}))}function G(t){const e=L.value[t];if(e){const l=e.getBoundingClientRect();P.value[t]={top:l.bottom,left:l.left,width:l.width}}}function X(t){const e=P.value[t];return e?{position:"fixed",top:`${e.top}px`,left:`${e.left}px`,width:`${e.width}px`,zIndex:1e4}:{}}function ue(){Object.keys(v.value).forEach(t=>{const e=parseInt(t,10);v.value[e]=!1}),Object.keys(z.value).forEach(t=>{z.value[t]?.closeMenu()})}function re(){Object.keys(v.value).forEach(t=>{const e=parseInt(t,10);v.value[e]&&G(e)})}function Q(t,e){let l;return function(){l||(t(),l=!0,setTimeout(()=>l=!1,e))}}const Y=Q(re,200);function C(t){return t?typeof t=="string"?t:t.start:""}function J(t){return t?typeof t=="string"?t:t.end:""}function K(t,e){if(!e||!t.options)return"";const l=t.options.find(o=>o.value===e);return l?l.label:e}function q(t,e){return!e||!t.options?"":e.map(l=>{const o=t.options.find(a=>a.value===l);return o?o.label:l}).filter(Boolean).join(", ")}function Z(){Object.keys(_.value).forEach(t=>{const e=parseInt(t,10);_.value[e]?(u.value[e]=_.value[e],u.value[e]=d.value[e].label+": "+u.value[e]):delete u.value[e]}),Object.keys(w.value).forEach(t=>{const e=parseInt(t,10);w.value[e]!==void 0&&w.value[e]!==null?(u.value[e]=w.value[e].toString()+d.value[e].unit,u.value[e]=d.value[e].label+": "+u.value[e]):delete u.value[e]}),Object.keys(V.value).forEach(t=>{const e=parseInt(t,10);V.value[e]?(u.value[e]=V.value[e].toLocaleString(),u.value[e]=d.value[e].label+": "+u.value[e]):delete u.value[e]}),Object.keys(b.value).forEach(t=>{const e=parseInt(t,10),l=b.value[e];l&&l.start&&l.end?(u.value[e]=`${l.start.toLocaleString()} ~ ${l.end.toLocaleString()}`,u.value[e]=d.value[e].label+": "+u.value[e]):delete u.value[e]}),Object.keys(g.value).forEach(t=>{const e=parseInt(t,10),l=g.value[e];if(l&&l.start!==void 0&&l.end!==void 0){const o=d.value[e].unit;u.value[e]=`${l.start}${o} ~ ${l.end}${o}`,u.value[e]=d.value[e].label+": "+u.value[e]}else delete u.value[e]}),Object.keys(k.value).forEach(t=>{const e=parseInt(t,10),l=d.value[e];k.value[e]?(u.value[e]=K(l,k.value[e])||k.value[e],u.value[e]=d.value[e].label+": "+u.value[e]):delete u.value[e]}),Object.keys(y.value).forEach(t=>{const e=parseInt(t,10),l=d.value[e];y.value[e]&&y.value[e].length>0?(u.value[e]=q(l,y.value[e])||y.value[e].join(", "),u.value[e]=d.value[e].label+": "+u.value[e]):delete u.value[e]})}function ee(){d.value.forEach((t,e)=>{if(!(t.default===void 0||t.default==null))switch(t.type){case"text":_.value[e]=t.default||"";break;case"number":w.value[e]=t.default||0;break;case"date":V.value[e]=t.default?new Date(t.default):null;break;case"dateRange":if(t.default&&typeof t.default=="object"&&!Array.isArray(t.default)){const l=t.default;b.value[e]={start:new Date(l.start),end:new Date(l.end)}}else b.value[e]={start:null,end:null};break;case"numberRange":if(t.default&&typeof t.default=="object"&&!Array.isArray(t.default)){const l=t.default;g.value[e]={start:l.start,end:l.end}}else g.value[e]={start:0,end:0};break;case"singleSelect":k.value[e]=t.default||"";break;case"multiSelect":y.value[e]=t.default||[];break}}),x()}function ce(){Z(),A()}function te(){if(!M.value)return;const t=M.value.clientWidth;t<768||t<1024?S.value=80:t<1280?S.value=120:(t<1536,S.value=160)}function ie(t){const e=t.gridX||1,l=t.gridY||1,o=t.gridWidth||4,a=t.gridHeight||4,s=e+o,E=l+a;return{gridColumn:`${e} / ${s}`,gridRow:`${l} / ${E}`,minHeight:`${a*S.value}px`}}const le=Q(te,100);return ve(async()=>{try{const t="http://vms-dev-2062032097.ap-southeast-1.elb.amazonaws.com/chart/myagent/dashboard/charts-filters",e=await fetch(t);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const l=await e.json();l.filters&&(d.value=l.filters,ee(),Z()),te(),H.value=l.charts||[]}catch(t){console.error("Error fetching chart data:",t)}window.addEventListener("resize",Y),window.addEventListener("resize",le)}),pe(()=>{window.removeEventListener("resize",Y),window.removeEventListener("resize",le)}),(t,e)=>{const l=ye("FontAwesomeIcon");return r(),c("div",Ue,[n("div",{class:ke(["popup-model",{active:I.value}]),onClick:A},[n("div",{class:"popup-content shadow-lg",onClick:e[2]||(e[2]=fe(()=>{},["stop"]))},[d.value.length==0?(r(),c("div",$e,[p(l,{icon:f(me),class:"mb-2 text-6xl"},null,8,["icon"]),e[3]||(e[3]=U("沒有任何篩選項 ",-1))])):(r(),c("div",{key:1,class:"popup-body",onScroll:ue},[n("div",ze,[n("div",Ae,[(r(!0),c(m,null,$(d.value,(o,a)=>(r(),c("div",{key:a,class:"input-group"},[n("div",De,h(o.label),1),n("div",Re,[o.type=="text"?j((r(),c("input",{key:0,class:"text-input",type:"text",placeholder:C(o.placeholder),"onUpdate:modelValue":s=>_.value[a]=s},null,8,Ie)),[[R,_.value[a]]]):o.type=="date"?(r(),D(f(O),{key:1,ref_for:!0,ref:s=>N(s,a),placeholder:C(o.placeholder),modelValue:V.value[a],"onUpdate:modelValue":s=>V.value[a]=s,format:"yyyy-MM-dd HH:mm:ss","enable-time-picker":!0,locale:"zh-TW",teleport:!0,"z-index":1e4},null,8,["placeholder","modelValue","onUpdate:modelValue"])):o.type=="dateRange"?(r(),c(m,{key:2},[p(f(O),{ref_for:!0,ref:s=>N(s,a,"start"),placeholder:C(o.placeholder),modelValue:b.value[a].start,"onUpdate:modelValue":s=>b.value[a].start=s,format:"yyyy-MM-dd HH:mm:ss","enable-time-picker":!0,locale:"zh-TW",teleport:!0,"z-index":1e4},null,8,["placeholder","modelValue","onUpdate:modelValue"]),e[4]||(e[4]=n("span",null,"~",-1)),p(f(O),{ref_for:!0,ref:s=>N(s,a,"end"),placeholder:J(o.placeholder),modelValue:b.value[a].end,"onUpdate:modelValue":s=>b.value[a].end=s,format:"yyyy-MM-dd HH:mm:ss","enable-time-picker":!0,locale:"zh-TW",teleport:!0,"z-index":1e4},null,8,["placeholder","modelValue","onUpdate:modelValue"])],64)):o.type=="number"?(r(),c(m,{key:3},[j(n("input",{type:"number",placeholder:C(o.placeholder),"onUpdate:modelValue":s=>w.value[a]=s},null,8,Me),[[R,w.value[a]]]),n("span",null,h(o.unit),1)],64)):o.type=="numberRange"?(r(),c(m,{key:4},[j(n("input",{type:"number",placeholder:C(o.placeholder),"onUpdate:modelValue":s=>g.value[a].start=s},null,8,Ne),[[R,g.value[a].start]]),n("span",null,h(o.unit),1),e[5]||(e[5]=n("span",null,"~",-1)),j(n("input",{type:"number",placeholder:J(o.placeholder),"onUpdate:modelValue":s=>g.value[a].end=s},null,8,Te),[[R,g.value[a].end]]),n("span",null,h(o.unit),1)],64)):o.type=="singleSelect"?(r(),c(m,{key:5},[n("div",{class:"select-title",ref_for:!0,ref:s=>B(s,a),onClick:s=>W(a)},[n("span",null,h(K(o,k.value[a])||o.placeholder),1),p(l,{icon:f(ae)},null,8,["icon"])],8,Oe),p(ne,{name:"fade",mode:"out-in"},{default:oe(()=>[(r(),D(se,{to:"body"},[v.value[a]?(r(),c("div",{key:0,class:"select-options",style:F(X(a))},[(r(!0),c(m,null,$(o.options,s=>(r(),c("label",{key:s.value},[j(n("input",{type:"radio",value:s.value,"onUpdate:modelValue":E=>k.value[a]=E},null,8,Fe),[[Ve,k.value[a]]]),n("span",null,h(s.label),1)]))),128))],4)):T("",!0)]))]),_:2},1024)],64)):o.type=="multiSelect"?(r(),c(m,{key:6},[n("div",{class:"select-title",ref_for:!0,ref:s=>B(s,a),onClick:s=>W(a)},[n("span",null,h(q(o,y.value[a])||o.placeholder),1),p(l,{icon:f(ae)},null,8,["icon"])],8,He),p(ne,{name:"fade",mode:"out-in"},{default:oe(()=>[(r(),D(se,{to:"body"},[v.value[a]?(r(),c("div",{key:0,class:"select-options",style:F(X(a))},[(r(!0),c(m,null,$(o.options,s=>(r(),c("label",{key:s.value},[j(n("input",{type:"checkbox",value:s.value,"onUpdate:modelValue":E=>y.value[a]=E},null,8,Le),[[Se,y.value[a]]]),n("span",null,h(s.label),1)]))),128))],4)):T("",!0)]))]),_:2},1024)],64)):T("",!0)])]))),128))])])],32)),n("div",Pe,[n("button",{class:"flex w-[8rem] items-center justify-center rounded-full bg-gray-500 px-4 py-2 text-sm font-semibold text-white hover:bg-gray-600",onClick:A},[p(l,{icon:f(he),class:"mr-1"},null,8,["icon"]),e[6]||(e[6]=U("關閉 ",-1))]),n("div",Be,[n("button",{class:"flex w-[8rem] items-center justify-center rounded-full bg-blue-400 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-500",onClick:e[0]||(e[0]=o=>ee())},[p(l,{icon:f(be),class:"mr-1"},null,8,["icon"]),e[7]||(e[7]=U("重置 ",-1))]),n("button",{class:"flex w-[8rem] items-center justify-center rounded-full bg-blue-500 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-600",onClick:e[1]||(e[1]=o=>ce())},[p(l,{icon:f(ge),class:"mr-1"},null,8,["icon"]),e[8]||(e[8]=U("套用 ",-1))])])])])],2),n("div",xe,[n("span",We,[p(l,{icon:f(we),class:"text-[#456882]"},null,8,["icon"]),e[9]||(e[9]=U(" 篩選項 ",-1))]),n("div",Ge,[(r(!0),c(m,null,$(u.value,(o,a)=>(r(),c("div",{class:"filter-tag",key:a},[e[10]||(e[10]=n("div",{class:"filter-tag-hole"},null,-1)),n("span",Xe,h(o),1)]))),128))]),n("button",{class:"text-base text-[#456882]",onClick:A},[p(l,{icon:f(_e)},null,8,["icon"])])]),n("div",{ref_key:"chartGridRef",ref:M,class:"chart-grid mt-6"},[(r(!0),c(m,null,$(H.value,(o,a)=>(r(),c("div",{key:a,style:F(ie(o)),class:"overflow-hidden rounded-lg bg-white shadow-lg"},[(r(),D(je,{key:a,"chart-json":o},null,8,["chart-json"]))],4))),128))],512)])}}}),Ke=Ee(Qe,[["__scopeId","data-v-3c4c2550"]]);export{Ke as default};
